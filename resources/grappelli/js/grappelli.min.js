var grp={jQuery:jQuery.noConflict(!0)},django={jQuery:grp.jQuery},jQuery=grp.jQuery,inputTypes=["[type='search']","[type='email']","[type='url']","[type='tel']","[type='number']","[type='range']","[type='date']","[type='month']","[type='week']","[type='time']","[type='datetime']","[type='datetime-local']","[type='color']"].join(",");!function(r){grappelli.getFormat=function(e){if("date"==e)return DATE_FORMAT.toLowerCase().replace(/%\w/g,function(e){return(e=e.replace(/%/,""))+e})},grappelli.cleanInputTypes=function(){r("form").each(function(){r(this).find(":input").filter(inputTypes).each(function(){r(this).attr("type","text")})})},grappelli.initDateAndTimePicker=function(){r("p.datetime").each(function(){var e=(e=(e=r(this).html()).replace(/\w*: /,"")).replace(/<br>[^<]*: /g,"<br>");r(this).html(e)});var e={constrainInput:!1,showOn:"button",buttonImageOnly:!1,buttonText:"",dateFormat:grappelli.getFormat("date"),showButtonPanel:!0,showAnim:"",beforeShow:function(e,t,a){grappelli.datepicker_instance=this}},t=r("input[class*='vDateField']:not([id*='__prefix__'])");t.datepicker(e),"undefined"!=typeof IS_POPUP&&IS_POPUP&&t.datepicker("disable"),r(document).on("click",".ui-datepicker-current",function(){r.datepicker._selectDate(grappelli.datepicker_instance),grappelli.datepicker_instance=null}),r("input[class*='vTimeField']:not([id*='__prefix__'])").grp_timepicker()},grappelli.initFilter=function(e){var n;r("a.grp-pulldown-handler").on("click",function(){var e=r(this).closest(".grp-pulldown-container");r(e).toggleClass("grp-pulldown-state-open").children(".grp-pulldown-content").toggle()}),r("a.grp-pulldown-handler").on("mouseout",function(){r(this).blur()}),e||r(".grp-filter-choice").change(function(){location.href=r(this).val()}),"confirm"===e&&(e=window.location.search.replace("?","").split("&"),n=[],void 0!==e[0]&&""!==e[0]&&e.map(e=>{var t=e.split("=")[0];-1!=t.search("__")&&(t=e.split("__")[0]),-1===n.findIndex(e=>e.fieldName===t)?n.push({fieldName:t,values:[e]}):n.find(e=>e.fieldName===t).values.push(e)}),r(".grp-filter-choice").change(function(){var t=r(this).data("field-name"),e="?"!==r(this).val()&&r(this).val().replace("?",""),a=e&&e.split("&"),e=a&&a.filter(e=>e.includes(t)),a=n.findIndex(e=>e.fieldName===t);a<0?0<e.length&&n.push({fieldName:t,values:e}):0<e.length?n.find(e=>e.fieldName===t).values=e:n.splice(a,1);a=n.flatMap(e=>e.values).join("&");r(this).closest(".grp-filter").find("#grp-filter-apply").attr("href","?"+a)}))},grappelli.initSearchbar=function(){r("input.grp-search-field").trigger("focus")},grappelli.updateSelectFilter=function(e){"undefined"!=typeof SelectFilter&&(e.find(".selectfilter").each(function(e,t){var a=t.name.split("-");SelectFilter.init(t.id,a[a.length-1],!1,"{% admin_media_prefix %}")}),e.find(".selectfilterstacked").each(function(e,t){var a=t.name.split("-");SelectFilter.init(t.id,a[a.length-1],!0,"{% admin_media_prefix %}")}))},grappelli.reinitDateTimeFields=function(e){e.find(".vDateField").datepicker({constrainInput:!1,showOn:"button",buttonImageOnly:!1,buttonText:"",dateFormat:grappelli.getFormat("date")}),e.find(".vTimeField").grp_timepicker()},grappelli.get_app_label=function(e){e=e.next("a");if(0<e.length){e=e.attr("href").split("?")[0].split("/");return e[e.length-3]}return!1},grappelli.get_model_name=function(e){e=e.next("a");if(0<e.length){e=e.attr("href").split("?")[0].split("/");return e[e.length-2]}return!1},grappelli.get_query_string=function(e){e=e.next("a");if(0<e.length){e=e.attr("href").split("/");return pairs=e[e.length-1].replace("?","").split("&"),pairs.join(":")}return!1},grappelli.get_to_field=function(e){e=e.next("a");if(0<e.length&&-1!==e.attr("href").indexOf("_to_field"))for(var e=e.attr("href").split("/"),t=e[e.length-1].replace("?","").split("&"),a=0;a<t.length;a++)if(v=t[a].split("="),"_to_field"==v[0])return v[1];return!1}}(grp.jQuery),function(r){var t={init:function(t){return t=r.extend({},r.fn.grp_autocomplete_fk.defaults,t),this.each(function(){var e=r(this);e.attr({tabindex:"-1",readonly:"readonly"}).addClass("grp-autocomplete-hidden-field"),e.next().next()&&"errorlist"!=e.next().next().attr("class")&&"grp-help"!=e.next().next().attr("class")&&e.next().next().remove(),e.next().after(a).after(n(e.attr("id"))),e.parent().wrapInner("<div class='grp-autocomplete-wrapper-fk'></div>"),e.parent().prepend("<input id='"+e.attr("id")+"-autocomplete' type='text' class='vTextField' value='' />"),t=r.extend({wrapper_autocomplete:e.parent(),input_field:e.prev(),remove_link:e.next().next().hide(),loader:e.next().next().next().hide()},r.fn.grp_autocomplete_fk.defaults,t),i(e,t),l(e,t),e.on("change focus keyup",function(){i(e,t)}),r("label[for='"+e.attr("id")+"']").each(function(){r(this).attr("for",e.attr("id")+"-autocomplete")})})}};r.fn.grp_autocomplete_fk=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(r.error("Method "+e+" does not exist on jQuery.grp_autocomplete_fk"),!1):t.init.apply(this,arguments)};var a=function(){return r('<div class="grp-loader">loader</div>')},n=function(e){var t=r('<a class="grp-related-remove"></a>');return t.attr("id","remove_"+e),t.attr("href","javascript://"),t.attr("onClick","return removeRelatedObject(this);"),t.hover(function(){r(this).parent().toggleClass("grp-autocomplete-preremove")}),t},l=function(a,n){n.wrapper_autocomplete.find("input:first").on("focus",function(){n.wrapper_autocomplete.addClass("grp-state-focus")}).on("blur",function(){n.wrapper_autocomplete.removeClass("grp-state-focus")}).autocomplete({minLength:1,autoFocus:!0,delay:1e3,source:function(e,t){r.ajax({url:n.autocomplete_lookup_url,dataType:"json",data:"term="+encodeURIComponent(e.term)+"&app_label="+grappelli.get_app_label(a)+"&model_name="+grappelli.get_model_name(a)+"&query_string="+grappelli.get_query_string(a)+"&to_field="+grappelli.get_to_field(a),beforeSend:function(e){n.loader.show()},success:function(e){t(r.map(e,function(e){return{label:e.label,value:e.value}}))},complete:function(e,t){n.loader.hide()}})},focus:function(){return!1},select:function(e,t){return n.input_field.val(t.item.label),a.val(t.item.value),a.trigger("change"),a.val()?r(n.remove_link).show():r(n.remove_link).hide(),!1}}).data("ui-autocomplete")._renderItem=function(e,t){return(t.value?r("<li></li>").data("item.autocomplete",t).append(r("<a></a>").text(t.label)):r("<li class='ui-state-disabled'></li>").data("item.autocomplete",t).append(r("<span class='error'></span>").text(t.label))).appendTo(e)}},i=function(a,n){r.getJSON(n.lookup_url,{object_id:a.val(),app_label:grappelli.get_app_label(a),model_name:grappelli.get_model_name(a),query_string:grappelli.get_query_string(a),to_field:grappelli.get_to_field(a)},function(t){r.each(t,function(e){n.input_field.val(t[e].label),a.val()?r(n.remove_link).show():r(n.remove_link).hide()})})};r.fn.grp_autocomplete_fk.defaults={autocomplete_lookup_url:"",lookup_url:""}}(grp.jQuery),function(r){var t={init:function(a){return a=r.extend({},r.fn.grp_autocomplete_generic.defaults,a),this.each(function(){var e=r(this);e.attr({tabindex:"-1",readonly:"readonly"}).addClass("grp-autocomplete-hidden-field");var t=r(a.content_type).val()||r(a.content_type).find(":checked").val();t&&e.after(n).after(l(e.attr("id"))).after(i(e.attr("id"),t)),e.parent().wrapInner("<div class='grp-autocomplete-wrapper-fk'></div>"),e.parent().prepend("<input id='"+e.attr("id")+"-autocomplete' type='text' class='vTextField' value='' />"),a=r.extend({wrapper_autocomplete:r(this).parent(),input_field:r(this).prev(),remove_link:e.nextAll("a.grp-related-remove").hide(),loader:e.nextAll("div.grp-loader").hide()},r.fn.grp_autocomplete_generic.defaults,a),t&&s(e,a),p(e,a),e.on("change focus keyup",function(){s(e,a)}),r(a.content_type).on("change",function(){o(r(this),a)}),r("label[for='"+e.attr("id")+"']").each(function(){r(this).attr("for",e.attr("id")+"-autocomplete")})})}};r.fn.grp_autocomplete_generic=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(r.error("Method "+e+" does not exist on jQuery.grp_autocomplete_generic"),!1):t.init.apply(this,arguments)};var n=function(){return r('<div class="grp-loader">loader</div>')},l=function(e){var t=r('<a class="grp-related-remove"></a>');return t.attr("id","remove_"+e),t.attr("href","javascript://"),t.attr("onClick","return removeRelatedObject(this);"),t.hover(function(){r(this).parent().toggleClass("grp-autocomplete-preremove")}),t},i=function(e,t){var a=r('<a class="related-lookup"></a>');return a.attr("id","lookup_"+e),a.attr("href",window.ADMIN_URL+MODEL_URL_ARRAY[t].app+"/"+MODEL_URL_ARRAY[t].model+"/?"),a.attr("onClick","return showRelatedObjectLookupPopup(this);"),a},o=function(e,t){var a=r(t.object_id);a.val(""),a.prev().val(""),a.nextAll("a.related-lookup").remove(),a.nextAll("a.grp-related-remove").remove(),a.nextAll("div.grp-loader").remove();e=r(e).val()||r(e).find(":checked").val();e&&(a.after(n).after(l(a.attr("id"))).after(i(a.attr("id"),e)),t.remove_link=a.nextAll("a.grp-related-remove").hide(),t.loader=a.nextAll("div.grp-loader").hide())},p=function(a,n){n.wrapper_autocomplete.find("input:first").on("focus",function(){n.wrapper_autocomplete.addClass("grp-state-focus")}).on("blur",function(){n.wrapper_autocomplete.removeClass("grp-state-focus")}).autocomplete({minLength:1,autoFocus:!0,delay:1e3,source:function(e,t){r.ajax({url:n.autocomplete_lookup_url,dataType:"json",data:"term="+encodeURIComponent(e.term)+"&app_label="+grappelli.get_app_label(a)+"&model_name="+grappelli.get_model_name(a)+"&query_string="+grappelli.get_query_string(a),beforeSend:function(e){if(!r(n.content_type).val()&&!r(n.content_type).find(":checked").val())return!1;n.loader.show()},success:function(e){t(r.map(e,function(e){return{label:e.label,value:e.value}}))},complete:function(e,t){n.loader.hide()}})},focus:function(){return!1},select:function(e,t){return n.input_field.val(t.item.label),a.val(t.item.value),a.trigger("change"),a.val()?r(n.remove_link).show():r(n.remove_link).hide(),!1}}).data("ui-autocomplete")._renderItem=function(e,t){return(t.value?r("<li></li>").data("item.autocomplete",t).append(r("<a></a>").text(t.label)):r("<li class='ui-state-disabled'></li>").data("item.autocomplete",t).append(r("<span class='error'></span>").text(t.label))).appendTo(e)}},s=function(a,n){r.getJSON(n.lookup_url,{object_id:a.val(),app_label:grappelli.get_app_label(a),model_name:grappelli.get_model_name(a)},function(t){r.each(t,function(e){n.input_field.val(t[e].label),a.val()?r(n.remove_link).show():r(n.remove_link).hide()})})};r.fn.grp_autocomplete_generic.defaults={autocomplete_lookup_url:"",lookup_url:"",content_type:"",object_id:""}}(grp.jQuery),function(i){var t={init:function(t){return t=i.extend({},i.fn.grp_autocomplete_m2m.defaults,t),this.each(function(){var e=i(this);e.attr({tabindex:"-1",readonly:"readonly"}).addClass("grp-autocomplete-hidden-field"),e.next().after(a).after(n(e.attr("id"))),e.parent().wrapInner("<div class='grp-autocomplete-wrapper-m2m'></div>"),e.parent().prepend("<ul class='grp-repr'><li class='grp-search'><input id='"+e.attr("id")+"-autocomplete' type='text' class='vTextField' value='' /></li></ul>"),t=i.extend({wrapper_autocomplete:e.parent(),wrapper_repr:e.parent().find("ul.grp-repr"),wrapper_search:e.parent().find("li.grp-search"),remove_link:e.next().next().hide(),loader:e.next().next().next().hide()},i.fn.grp_autocomplete_m2m.defaults,t),e.parent().find("ul.errorlist")&&e.parent().find("ul.errorlist").detach().appendTo(e.parent().parent()),e.parent().find("p.grp-help")&&e.parent().find("p.grp-help").detach().appendTo(e.parent().parent()),l(e,t),r(e,t),e.on("change focus keyup",function(){l(e,t)}),i("label[for='"+e.attr("id")+"']").each(function(){i(this).attr("for",e.attr("id")+"-autocomplete")}),t.wrapper_autocomplete.on("click",function(e){i(e.target).hasClass("related-lookup")||i(e.target).hasClass("grp-related-remove")||t.wrapper_search.find("input:first").trigger("focus")})})}};function o(r,e,l){var t=i('<li class="grp-repr"></li>'),e=i('<a class="grp-m2m-remove" href="javascript://"></a>').text(e);t.append(e),t.insertBefore(l.wrapper_search),e.on("click",function(e){var t,a,n=i(this).parent().parent().children("li").index(i(this).parent());t=n,a=[],(n=r).val()&&(a=n.val().split(",")),a.splice(t,1),n.val(a.join(",")),n.trigger("change"),a.join(","),i(this).parent().remove(),r.val()?i(l.remove_link).show():i(l.remove_link).hide(),e.stopPropagation()}),e.hover(function(){i(this).parent().toggleClass("grp-autocomplete-preremove")})}i.fn.grp_autocomplete_m2m=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(i.error("Method "+e+" does not exist on jQuery.grp_autocomplete_m2m"),!1):t.init.apply(this,arguments)};var a=function(){return i('<div class="grp-loader">loader</div>')},n=function(e){var t=i('<a class="grp-related-remove"></a>');return t.attr("id","remove_"+e),t.attr("href","javascript://"),t.attr("onClick","return removeRelatedObject(this);"),t.hover(function(){i(this).parent().toggleClass("grp-autocomplete-preremove")}),t},r=function(r,l){l.wrapper_search.find("input:first").on("keydown",function(e){e.keyCode===i.ui.keyCode.TAB&&i(this).data("uiAutocomplete").menu.active&&e.preventDefault()}).on("focus",function(){l.wrapper_autocomplete.addClass("grp-state-focus")}).on("blur",function(){l.wrapper_autocomplete.removeClass("grp-state-focus")}).autocomplete({minLength:1,autoFocus:!0,delay:1e3,position:{my:"left top",at:"left bottom",of:l.wrapper_autocomplete},open:function(e,t){i(".ui-menu").width(l.wrapper_autocomplete.outerWidth()-6)},source:function(e,t){i.ajax({url:l.autocomplete_lookup_url,dataType:"json",data:"term="+encodeURIComponent(e.term)+"&app_label="+grappelli.get_app_label(r)+"&model_name="+grappelli.get_model_name(r)+"&query_string="+grappelli.get_query_string(r),beforeSend:function(e){l.loader.show()},success:function(e){t(i.map(e,function(e){return{label:e.label,value:e.value}}))},complete:function(e,t){l.loader.hide()}})},focus:function(){return!1},select:function(e,t){return o(r,t.item.label,l),a=r,n=t.item.value,t=[],a.val()&&(t=a.val().split(",")),t.push(n),a.val(t.join(",")),a.trigger("change"),t.join(","),r.val()?i(l.remove_link).show():i(l.remove_link).hide(),i(this).val("").trigger("focus"),!1;var a,n}}).data("ui-autocomplete")._renderItem=function(e,t){return(t.value?i("<li></li>").data("item.autocomplete",t).append(i("<a></a>").text(t.label)):i("<li class='ui-state-disabled'></li>").data("item.autocomplete",t).append(i("<span class='error'></span>").text(t.label))).appendTo(e)}},l=function(a,n){i.getJSON(n.lookup_url,{object_id:a.val(),app_label:grappelli.get_app_label(a),model_name:grappelli.get_model_name(a)},function(t){n.wrapper_repr.find("li.grp-repr").remove(),n.wrapper_search.find("input").val(""),i.each(t,function(e){t[e].value&&o(a,t[e].label,n)}),a.val()?i(n.remove_link).show():i(n.remove_link).hide()})}}(grp.jQuery),function(a){a.fn.grp_collapsible_group=function(e){return e=a.extend({open_handler_slctr:".grp-open-handler",close_handler_slctr:".grp-close-handler",collapsible_container_slctr:".grp-collapse",closed_css:"grp-closed",open_css:"grp-open",on_init:function(){},on_open:function(){},on_close:function(){}},e),this.each(function(){t(a(this),e)})};var t=function(e,t){t.on_init(e,t),n(e,t)},n=function(e,t){r(e,t),l(e,t)},r=function(e,t){e.find(t.open_handler_slctr).each(function(){a(this).on("click",function(){t.on_open(e,t),e.find(t.collapsible_container_slctr).removeClass(t.closed_css).addClass(t.open_css),e.removeClass(t.closed_css).addClass(t.open_css)})})},l=function(e,t){e.find(t.close_handler_slctr).each(function(){a(this).on("click",function(){t.on_close(e,t),e.find(t.collapsible_container_slctr).removeClass(t.open_css).addClass(t.closed_css)})})}}(grp.jQuery),function(a){a.fn.grp_collapsible=function(e){var t=a.extend({toggle_handler_slctr:".grp-collapse-handler:first",closed_css:"grp-closed",open_css:"grp-open",on_init:function(){},on_toggle:function(){}},e);return this.each(function(){n(a(this),t)})};var n=function(e,t){t.on_init(e,t),r(e,t)},r=function(e,t){l(e,t)},l=function(e,t){e.children(t.toggle_handler_slctr).on("click",function(){e.toggleClass(t.closed_css).toggleClass(t.open_css),t.on_toggle(e,t)})}}(grp.jQuery),function(s){s.fn.grp_inline=function(t){return t=s.extend({prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"grp-add-handler",removeCssClass:"grp-remove-handler",deleteCssClass:"grp-delete-handler",emptyCssClass:"grp-empty-form",formCssClass:"grp-dynamic-form",predeleteCssClass:"grp-predelete",onBeforeInit:function(e){},onBeforeAdded:function(e){},onBeforeRemoved:function(e){},onBeforeDeleted:function(e){},onAfterInit:function(e){},onAfterAdded:function(e){},onAfterRemoved:function(e){},onAfterDeleted:function(e){}},t),this.each(function(){var e=s(this);e.find("#id_"+t.prefix+"-TOTAL_FORMS").attr("autocomplete","off"),initInlineForms(e,t),initAddButtons(e,t),addButtonHandler(e.find("a."+t.addCssClass),t),removeButtonHandler(e.find("a."+t.removeCssClass),t),deleteButtonHandler(e.find("a."+t.deleteCssClass),t)})},getFormIndex=function(e,t,a){t=e.find("[id^='id_"+t.prefix+"']").attr("id");return t?parseInt(a.exec(t)[1],10):-1},updateFormIndex=function(e,t,o,p){e.find(":input,span,table,iframe,label,a,ul,p,img,div").each(function(){var e=s(this),t=e.attr("id"),a=e.attr("name"),n=e.attr("for"),r=e.attr("href"),l=e.attr("class"),i=e.attr("onclick");t&&e.attr("id",t.replace(o,p)),a&&e.attr("name",a.replace(o,p)),n&&e.attr("for",n.replace(o,p)),r&&e.attr("href",r.replace(o,p)),l&&e.attr("class",l.replace(o,p)),i&&e.attr("onclick",i.replace(o,p))}),e.find(".prepopulated_field").each(function(){var e=s(this).data("dependency_ids")||[],a=[];s.each(e,function(e,t){a.push(t.replace(o,p))}),s(this).data("dependency_ids",a)})},initInlineForms=function(e,t){e.find("div.grp-module").each(function(){var e=s(this);t.onBeforeInit(e),""!==e.attr("id")&&e.not("."+t.emptyCssClass).not(".grp-table").not(".grp-thead").not(".add-item").addClass(t.formCssClass),e.find("li.grp-delete-handler-container input").each(function(){s(this).is(":checked")&&e.hasClass("has_original")&&e.toggleClass(t.predeleteCssClass)}),t.onAfterInit(e)})},initAddButtons=function(e,t){var a=e.find("#id_"+t.prefix+"-TOTAL_FORMS"),n=e.find("#id_"+t.prefix+"-MAX_NUM_FORMS");e.find("a."+t.addCssClass),""!==n.val()&&n.val()-a.val()<=0&&hideAddButtons(e,t)},addButtonHandler=function(o,p){o.on("click",function(e){var t=o.parents(".grp-group"),a=t.find("#id_"+p.prefix+"-TOTAL_FORMS"),n=t.find("#id_"+p.prefix+"-MAX_NUM_FORMS"),r=(t.find("a."+p.addCssClass),t.find("#"+p.prefix+"-empty"));p.onBeforeAdded(t);var l=parseInt(a.val(),10),i=r.clone(!0);i.removeClass(p.emptyCssClass).attr("id",r.attr("id").replace("empty",l)),updateFormIndex(i,p,/__prefix__/g,l),i.insertBefore(r).addClass(p.formCssClass),a.val(l+1),0!==n.val()&&""!==n.val()&&n.val()-a.val()<=0&&hideAddButtons(t,p),i.find(".prepopulated_field").each(function(){var e=s(this).data("dependency_ids")||[];s(this).prepopulate(e,s(this).attr("maxlength"))}),django.jQuery(i).get(0).dispatchEvent(new CustomEvent("formset:added",{bubbles:!0,detail:{formsetName:p.prefix}})),p.onAfterAdded(i)})},removeButtonHandler=function(i,o){i.on("click",function(){var e=i.parents(".grp-group"),t=s(this).parents("."+o.formCssClass).first(),a=e.find("#id_"+o.prefix+"-TOTAL_FORMS"),n=e.find("#id_"+o.prefix+"-MAX_NUM_FORMS"),r=/-(\d+)-/,l=getFormIndex(t,o,r);o.onBeforeRemoved(t),t.remove(),a.val(parseInt(a.val(),10)-1),0!==n.val()&&0<n.val()-a.val()&&showAddButtons(e,o),e.find("."+o.formCssClass).each(function(){var e=s(this),t=getFormIndex(e,o,r);l<t&&updateFormIndex(e,o,r,"-"+(t-1)+"-")}),o.onAfterRemoved(e)})},deleteButtonHandler=function(e,a){e.on("click",function(){var e=s(this).prev(),t=s(this).parents("."+a.formCssClass).first();a.onBeforeDeleted(t),t.hasClass("has_original")&&(t.toggleClass(a.predeleteCssClass),e.prop("checked")?e.removeAttr("checked"):e.prop("checked",!0)),a.onAfterDeleted(t)})},hideAddButtons=function(e,t){t=e.find("a."+t.addCssClass);t.hide().parents(".grp-add-item").hide(),t.closest(".grp-module.grp-transparent").hide()},showAddButtons=function(e,t){t=e.find("a."+t.addCssClass);t.show().parents(".grp-add-item").show(),t.closest(".grp-module.grp-transparent").show()}}(grp.jQuery),function(n){var t={init:function(a){return a=n.extend({},n.fn.grp_related_fk.defaults,a),this.each(function(){var e=n(this),t=e.parent();t.find("a.related-lookup").next().is("strong")&&(t.find("a.related-lookup").get(0).nextSibling.nodeValue="",t.find("a.related-lookup").next("strong").remove()),t.find("a.related-lookup").after(a.placeholder),e.addClass("grp-has-related-lookup"),r(e,a),e.on("change focus keyup",function(){r(e,a)})})}};n.fn.grp_related_fk=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(n.error("Method "+e+" does not exist on jQuery.grp_related_fk"),!1):t.init.apply(this,arguments)};var r=function(e,t){var a=e.parent().find(".grp-placeholder-related-fk");n.getJSON(t.lookup_url,{object_id:e.val(),app_label:grappelli.get_app_label(e),model_name:grappelli.get_model_name(e),query_string:grappelli.get_query_string(e),to_field:grappelli.get_to_field(e)},function(e){""===e[0].label?a.hide():a.show(),e[0].safe?a.html(n('<span class="grp-placeholder-label"></span>').html(e[0].label+"‎")):a.html(n('<span class="grp-placeholder-label"></span>').text(e[0].label+"‎"))})};n.fn.grp_related_fk.defaults={placeholder:'<div class="grp-placeholder-related-fk"></div>',repr_max_length:30,lookup_url:""}}(grp.jQuery),function(n){var t={init:function(a){return a=n.extend({},n.fn.grp_related_generic.defaults,a),this.each(function(){var e=n(this),t=n(a.content_type).val()||n(a.content_type).find(":checked").val();t&&e.after(a.placeholder).after(r(e.attr("id"),t)),e.addClass("grp-has-related-lookup"),t&&i(e,a),e.on("change focus keyup",function(){i(e,a)}),n(a.content_type).on("change",function(){l(n(this),a)})})}};n.fn.grp_related_generic=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(n.error("Method "+e+" does not exist on jQuery.grp_related_generic"),!1):t.init.apply(this,arguments)};var r=function(e,t){var a=n('<a class="related-lookup"></a>');return a.attr("id","lookup_"+e),a.attr("href",window.ADMIN_URL+MODEL_URL_ARRAY[t].app+"/"+MODEL_URL_ARRAY[t].model+"/?"),a.attr("onClick","return showRelatedObjectLookupPopup(this);"),a},l=function(e,t){var a=n(t.object_id);a.val(""),a.parent().find("a.related-lookup").remove(),a.parent().find(".grp-placeholder-related-generic").remove();e=n(e).val()||n(e).find(":checked").val();e&&a.after(t.placeholder).after(r(a.attr("id"),e))},i=function(e,t){var a=e.next().next();n.getJSON(t.lookup_url,{object_id:e.val(),app_label:grappelli.get_app_label(e),model_name:grappelli.get_model_name(e),query_string:grappelli.get_query_string(e)},function(e){""===e[0].label?a.hide():a.show(),e[0].safe?a.html(n('<span class="grp-placeholder-label"></span>').html(e[0].label+"‎")):a.html(n('<span class="grp-placeholder-label"></span>').text(e[0].label+"‎"))})};n.fn.grp_related_generic.defaults={placeholder:'<div class="grp-placeholder-related-generic" style="display:none"></div>',repr_max_length:30,lookup_url:"",content_type:"",object_id:""}}(grp.jQuery),function(n){var t={init:function(t){return t=n.extend({},n.fn.grp_related_m2m.defaults,t),this.each(function(){var e=n(this);e.parent().find("a.related-lookup").after(t.placeholder),e.next().addClass("grp-m2m"),e.addClass("grp-has-related-lookup"),a(e,t),e.on("change focus keyup",function(){a(e,t)})})}};n.fn.grp_related_m2m=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(n.error("Method "+e+" does not exist on jQuery.grp_related_m2m"),!1):t.init.apply(this,arguments)};var a=function(e,t){n.getJSON(t.lookup_url,{object_id:e.val(),app_label:grappelli.get_app_label(e),model_name:grappelli.get_model_name(e),query_string:grappelli.get_query_string(e)},function(a){values=n.map(a,function(e,t){return a.length!==t+1||e.safe?a.length===t+1&&e.safe?n('<span class="grp-placeholder-label"></span>').html(e.label+"‎"):(e.safe?n('<span class="grp-placeholder-label"></span>').html(e.label+"‎"):n('<span class="grp-placeholder-label"></span>').text(e.label+"‎")).append(n('<span class="grp-separator"></span>')):n('<span class="grp-placeholder-label"></span>').text(e.label+"‎")}),""===values?e.parent().find(".grp-placeholder-related-m2m").hide():e.parent().find(".grp-placeholder-related-m2m").show(),e.parent().find(".grp-placeholder-related-m2m").html(values)})};n.fn.grp_related_m2m.defaults={placeholder:'<div class="grp-placeholder-related-m2m"></div>',repr_max_length:30,lookup_url:""}}(grp.jQuery),function(l){l.widget("ui.grp_timepicker",{options:{template:'<div id="ui-timepicker" class="module" style="position: absolute; display: none;"></div>',timepicker_selector:"#ui-timepicker",offset:{top:0},default_time_list:["now","00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],time_list:[]},_create:function(){var t=this;l(document).on("mousedown",function(e){t.timepicker.is(":visible")&&((e=l(e.target))[0].id==t.timepicker[0].id||0!==e.parents(t.options.timepicker_selector).length||e.hasClass("hasTimepicker")||e.hasClass("ui-timepicker-trigger")||t.timepicker.hide())}),l(document).on("keyup",function(e){27==e.keyCode&&t.timepicker.hide()}),0===l(this.options.timepicker_selector).length&&l(this.options.template).appendTo("body"),this.timepicker=l(this.options.timepicker_selector),this.timepicker.hide(),this.element.addClass("hasTimepicker"),this.button=l('<button type="button" class="ui-timepicker-trigger"></button>'),this.element.after(this.button),this.element.prop("disabled")?this.button.prop("disabled",!0):this.button.on("click",function(){t._toggleTimepicker()})},_toggleTimepicker:function(){this.timepicker.is(":visible")?this.timepicker.hide():(this.element.trigger("focus"),this._generateTimepickerContents(),this._showTimepicker())},_generateTimepickerContents:function(){var e=this,t="<ul>";0===this.options.time_list.length&&(this.options.time_list=this.options.default_time_list);for(var a,n,r=0;r<this.options.time_list.length;r++)"now"==this.options.time_list[r]?t+='<li class="ui-state-active row">'+(a=(a=(n=new Date).getHours())<10?"0"+a:a)+":"+(n=(n=n.getMinutes())<10?"0"+n:n)+"</li>":t+='<li class="ui-state-default row">'+this.options.time_list[r]+"</li>";t+="</ul>",this.timepicker.html(t),this.timepicker.find("li").on("click",function(){l(this).parent().children("li").removeClass("ui-state-active"),l(this).addClass("ui-state-active"),e.element.val(l(this).html()),e.timepicker.hide()})},_showTimepicker:function(){var e=document.documentElement.clientHeight,t=document.documentElement.scrollTop||document.body.scrollTop,a=this.element.outerHeight(),n=this.timepicker.outerHeight()+a,r=this.element.offset().top,l=this.element.offset().left;r-t+n+60<e?(e=r+a,this.timepicker.css("left",l+"px").css("top",e+"px")):(a=r-n+a,this.timepicker.css("left",l+"px").css("top",a+"px")),this.timepicker.show()},destroy:function(){l.Widget.prototype.destroy.apply(this,arguments)}})}(grp.jQuery);